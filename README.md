# config-magement-REPL

Небольшой учебный REPL-эмулятор UNIX-подобной командной строки с виртуальной файловой системой (VFS) в памяти.
Поддерживает запуск в интерактивном режиме и исполнение стартовых скриптов.

## Содержание

- [Возможности](#возможности)
- [Структура проекта](#структура-проекта)
- [Требования](#требования)
- [Сборка и запуск](#сборка-и-запуск)
- [Флаги запуска](#флаги-запуска)
- [Команды REPL](#команды-repl)
- [Снимки состояния VFS (snapshots)](#снимки-состояния-vfs-snapshots)
- [Формат JSON для VFS](#формат-json-для-vfs)
- [Пример дефолтной VFS](#пример-дефолтной-vfs)
- [Ограничения](#ограничения)
- [Планы / ToDo](#планы--todo)

## Возможности

- Интерактивная оболочка с поддержкой основных команд работы с файлами и каталогами.
- Виртуальная файловая система, полностью работающая в памяти — никаких реальных файлов, всё внутри программы.
- Команды для сохранения (`vfs-save`) и загрузки (`vfs-load`) состояния VFS из файлов в формате JSON.
- Поддержка скриптов для автоматизации работы с VFS — можно запускать серии команд сразу.
- Удобное управление конфигурациями и экспериментами с виртуальной файловой системой.

## Структура проекта

- `cmd/` — содержит основной исполняемый файл и точку входа в приложение.
- `internal/` — внутренние пакеты, реализующие логику виртуальной файловой системы, REPL, команды и другие компоненты.
- `snapshots/` — директория для хранения снимков состояния VFS.
- `start_scripts/` — содержит скрипты для инициализации и автоматизации работы с REPL.
- `scripts/bash/` — примеры bash-скриптов для тестирования эмулятора (разные варианты VFS и стартовые сценарии).

## Требования

- Go версии 1.21 или выше.

## Сборка и запуск

1. Склонируйте репозиторий:
   ```
   git clone <URL_репозитория>
   cd config-management-repl
   ```
2. Соберите проект:
   ```
   go build -o cmrepl ./cmd/cmrepl
   ```
3. Запустите REPL:
   ```
   ./cmrepl [флаги]
   ```
   
   Например, чтобы загрузить дефолтное состояние VFS:
   ```
   ./cmrepl
   ```

## Флаги запуска

- `-vfs <путь>` — загрузка состояния виртуальной файловой системы из указанного JSON-файла при старте.
- `-script <путь>` — выполнение скрипта команд REPL из файла при запуске.

## Команды REPL

| Команда    | Описание                                                           |
|------------|--------------------------------------------------------------------|
| `ls`       | Выводит список файлов и каталогов текущей директории              |
| `cd`       | Переход в указанный каталог                                        |
| `echo`     | Выводит указанный текст                                            |
| `exit`     | Выход из REPL                                                     |
| `clear`    | Очистка экрана REPL                                                |
| `uname`    | Выводит информацию о системе                                      |
| `cat`      | Выводит содержимое файла                                          |
| `uniq`     | Удаляет повторяющиеся строки из вывода или файла                   |
| `touch`    | Создает новый пустой файл или обновляет время последнего доступа  |
| `vfs-save` | Сохраняет текущее состояние VFS в JSON-файл                      |
| `vfs-load` | Загружает состояние VFS из JSON-файла                            |

Если вы не знаете, с чего начать, попробуйте команды `ls` и `cd` — они помогут ориентироваться в виртуальной файловой системе.

## Снимки состояния VFS (snapshots)

Вы можете сохранять состояние виртуальной файловой системы в любой момент, чтобы потом быстро восстановить его. Это удобно, если вы хотите экспериментировать, не боясь потерять данные.

Снимки хранятся в формате JSON и могут быть загружены обратно через команду `vfs-load`.

## Формат JSON для VFS

Формат JSON, используемый для сохранения состояния VFS, описывает структуру каталогов и файлов с их содержимым. Основные элементы:

- Каталоги представлены объектами с именами и списком вложенных элементов.
- Файлы содержат имя и содержимое в виде строки.

### Пример структуры:

```json
{
  "name": "/",
  "type": "directory",
  "children": [
    {
      "name": "config.json",
      "type": "file",
      "content": "{ \"setting\": true }"
    },
    {
      "name": "scripts",
      "type": "directory",
      "children": []
    }
  ]
}
```

## Пример дефолтной VFS

Для удобства в проекте есть файл с дефолтным состоянием виртуальной файловой системы: `internal/vfs/vfs_default.json`. Вот как он выглядит:

```json
{
  "name": "/",
  "type": "dir",
  "children": [
    {
      "name": "home",
      "type": "dir",
      "children": [
        {
          "name": "user",
          "type": "dir",
          "children": [
            {
              "name": "readme.txt",
              "type": "file",
              "contentText": "Добро пожаловать в виртуальную FS!"
            }
          ]
        }
      ]
    },
    {
      "name": "etc",
      "type": "dir",
      "children": [
        {
          "name": "config.json",
          "type": "file",
          "contentText": "{ \"version\": \"1.0\" }"
        }
      ]
    },
    {
      "name": "docs",
      "type": "dir",
      "children": [
        {
          "name": "manual.txt",
          "type": "file",
          "contentText": "Это пример документации."
        }
      ]
    }
  ]
}
```

Вы можете загрузить эту дефолтную VFS при старте REPL, чтобы сразу начать работать с уже готовой структурой.

## Ограничения

- VFS полностью виртуальна и не взаимодействует с реальной файловой системой по умолчанию.
- Поддерживается ограниченный набор команд и операций.
- Работа с большими файлами и глубоко вложенными структурами может быть ограничена производительностью.

## Планы / ToDo

- Расширение набора поддерживаемых команд.
- Добавление поддержки различных форматов конфигурационных файлов.
- Улучшение пользовательского интерфейса REPL.
- Интеграция с реальной файловой системой по выбору пользователя.
- Разработка системы плагинов для расширения функционала.

---

Спасибо за использование Config Management REPL! Если возникнут вопросы — не стесняйтесь обращаться и экспериментировать!
